{"version":3,"file":"showMore.min.js","sources":["../sources/utils/defaults.ts","../sources/utils/function.ts","../sources/utils/regex.ts","../sources/index.ts"],"sourcesContent":["export interface ShowMoreOptions {\r\n  typeElement: string;\r\n  more: string | false;\r\n  less: string | false;\r\n  number: boolean;\r\n  nobutton: boolean;\r\n  after: number;\r\n  btnClass: string;\r\n  btnClassAppend: string | null;\r\n  limit?: number;\r\n  type?: \"text\" | \"list\" | \"table\";\r\n  element?: HTMLElement;\r\n  ellipsis?: boolean | string;\r\n  removeElements?: string[];\r\n}\r\n\r\n/**\r\n * Default list of HTML elements to remove (with their content) for type=\"text\"\r\n */\r\nexport const defaultRemoveElements = [\r\n  // Tables\r\n  \"table\",\r\n  \"thead\",\r\n  \"tbody\",\r\n  \"tfoot\",\r\n  \"tr\",\r\n  \"td\",\r\n  \"th\",\r\n  // Lists\r\n  \"ul\",\r\n  \"ol\",\r\n  \"li\",\r\n  \"dl\",\r\n  \"dt\",\r\n  \"dd\",\r\n  // Multimedia\r\n  \"figure\",\r\n  \"figcaption\",\r\n  \"img\",\r\n  \"picture\",\r\n  \"source\",\r\n  \"video\",\r\n  \"audio\",\r\n  // Embedded content\r\n  \"iframe\",\r\n  \"object\",\r\n  \"embed\",\r\n  \"canvas\",\r\n  \"svg\",\r\n  // Scripts & styles\r\n  \"script\",\r\n  \"style\",\r\n  // Forms\r\n  \"form\",\r\n  \"input\",\r\n  \"select\",\r\n  \"textarea\",\r\n  \"button\",\r\n];\r\n\r\nexport const defaultOptions: Partial<ShowMoreOptions> = {\r\n  typeElement: \"span\",\r\n  more: false,\r\n  less: false,\r\n  number: false,\r\n  nobutton: false,\r\n  after: 0,\r\n  btnClass: \"show-more-btn\",\r\n  btnClassAppend: null,\r\n  removeElements: defaultRemoveElements,\r\n};\r\n","/**\r\n * Get hidden element count\r\n *\r\n * @param element - HTMLElement with rows or children\r\n * @param type - type of element table | list\r\n * @returns string with count or empty string\r\n */\r\nexport const getNumber = (\r\n  element: {\r\n    rows?: HTMLCollectionOf<HTMLTableRowElement>;\r\n    children?: HTMLCollection;\r\n  },\r\n  type: string,\r\n): string => {\r\n  const elementType = type === \"table\" ? element.rows : element.children;\r\n\r\n  if (!elementType) return \"\";\r\n\r\n  const numbersElementHidden = Array.from(elementType).filter((el) =>\r\n    el.classList.contains(\"hidden\"),\r\n  ).length;\r\n  return numbersElementHidden !== 0 ? ` ${numbersElementHidden}` : \"\";\r\n};\r\n\r\n/**\r\n * Remove specific HTML elements with their content\r\n *\r\n * @param html - HTML string\r\n * @param tags - Array of tag names to remove (e.g., ['table', 'img', 'figure'])\r\n * @returns HTML string without specified elements\r\n */\r\nexport const removeElements = (html: string, tags: string[]): string => {\r\n  const div = createElement(\"div\");\r\n  div.innerHTML = html;\r\n\r\n  tags.forEach((tag) => {\r\n    const elements = div.querySelectorAll(tag);\r\n    elements.forEach((el) => {\r\n      el.remove();\r\n    });\r\n  });\r\n\r\n  return div.innerHTML;\r\n};\r\n\r\n/**\r\n * Remove table rows where ALL cells are empty\r\n *\r\n * @param div - DOM element containing HTML\r\n */\r\nconst cleanupTableRows = (div: HTMLElement): void => {\r\n  const tables = div.querySelectorAll(\"table\");\r\n  tables.forEach((table) => {\r\n    const rows = table.querySelectorAll(\"tr\");\r\n    rows.forEach((row) => {\r\n      const cells = row.querySelectorAll(\"td, th\");\r\n      // Check if ALL cells in this row are empty\r\n      const allEmpty =\r\n        cells.length > 0 &&\r\n        Array.from(cells).every((cell) => !cell.textContent?.trim());\r\n      if (allEmpty) {\r\n        row.remove();\r\n      }\r\n    });\r\n  });\r\n};\r\n\r\n/**\r\n * Remove empty HTML tags recursively\r\n *\r\n * @param html - HTML string\r\n * @returns HTML string without empty tags\r\n */\r\nconst removeEmptyTags = (html: string): string => {\r\n  let cleaned = html;\r\n  let prev: string;\r\n\r\n  // Recursively remove empty tags (including nested ones)\r\n  // BUT keep table structure tags (td, th, tr) - they're handled separately\r\n  do {\r\n    prev = cleaned;\r\n    // Remove tags that contain only whitespace or &nbsp;\r\n    // Exclude: td, th, tr (table structure handled by cleanupTableRows)\r\n    cleaned = cleaned.replace(\r\n      /<((?!td|th|tr)\\w+)(\\s[^>]*)?>(\\s|&nbsp;|<br\\s*\\/?>)*<\\/\\1>/gi,\r\n      \"\",\r\n    );\r\n  } while (cleaned !== prev);\r\n\r\n  return cleaned;\r\n};\r\n\r\n// https://stackoverflow.com/questions/6003271/substring-text-with-html-tags-in-javascript\r\n/**\r\n * Substring text with html tags\r\n *\r\n * @param originalText - text with html tags\r\n * @param count - limit of characters\r\n * @returns truncated html string\r\n */\r\nexport const htmlSubstr = (originalText: string, count: number): string => {\r\n  const div = createElement(\"div\");\r\n  div.insertAdjacentHTML(\"afterbegin\", originalText);\r\n\r\n  let remaining = count;\r\n\r\n  walk(div, track);\r\n\r\n  function track(el: Text): void {\r\n    if (remaining > 0) {\r\n      const len = el.data.length;\r\n      remaining -= len;\r\n      if (remaining <= 0) {\r\n        el.data = el.substringData(0, el.data.length + remaining);\r\n      }\r\n    } else {\r\n      el.data = \"\";\r\n    }\r\n  }\r\n\r\n  function walk(el: Node, fn: (node: Text) => void): void {\r\n    let node = el.firstChild;\r\n    while (node) {\r\n      if (node.nodeType === 3) {\r\n        fn(node as Text);\r\n      } else if (node.nodeType === 1 && node.childNodes && node.childNodes[0]) {\r\n        walk(node, fn);\r\n      }\r\n      node = node.nextSibling;\r\n    }\r\n  }\r\n\r\n  // Clean up table rows where ALL cells are empty\r\n  cleanupTableRows(div);\r\n\r\n  // Remove empty tags after truncation\r\n  return removeEmptyTags(div.innerHTML);\r\n};\r\n\r\n/**\r\n * Add/remove class 'hidden' to element\r\n *\r\n * @param element - HTMLElement to modify\r\n * @param type - true to add, false to remove\r\n */\r\nexport const addRemoveClass = (element: Element, type = false): void => {\r\n  element.classList[type ? \"add\" : \"remove\"](\"hidden\");\r\n};\r\n\r\n/**\r\n * Set attributes to element\r\n *\r\n * @param el - HTMLElement to set attributes on\r\n * @param attributes - object with attribute key-value pairs\r\n */\r\nexport const setAttributes = (\r\n  el: HTMLElement,\r\n  attributes: Record<string, string | number | boolean>,\r\n): void => {\r\n  for (const key in attributes) {\r\n    el.setAttribute(key, String(attributes[key]));\r\n  }\r\n};\r\n\r\n/**\r\n * Create element\r\n *\r\n * @param type - type of element to create\r\n * @returns created HTMLElement\r\n */\r\nexport const createElement = <K extends keyof HTMLElementTagNameMap>(\r\n  type: K,\r\n): HTMLElementTagNameMap[K] => document.createElement(type);\r\n","export interface RegexRule {\r\n  match: RegExp;\r\n  replace: string;\r\n}\r\n\r\nexport interface RegexConfig {\r\n  newLine?: RegexRule;\r\n  space?: RegexRule;\r\n  br?: RegexRule;\r\n  html?: RegexRule;\r\n  [key: string]: RegexRule | undefined;\r\n}\r\n\r\n/**\r\n * Default regexes for validation\r\n *\r\n * For type=\"text\": removes all HTML tags except inline text formatting\r\n * - Keeps: <b>, <strong>, <i>, <em>, <u>, <mark>, <small>, <sub>, <sup>\r\n * - Removes: <table>, <ul>, <img>, <figure>, <div>, <p>, etc.\r\n */\r\nexport const defaultRegex: RegexConfig = {\r\n  newLine: {\r\n    match: /(\\r\\n|\\n|\\r)/gm,\r\n    replace: \" \",\r\n  },\r\n  space: {\r\n    match: /\\s\\s+/gm,\r\n    replace: \" \",\r\n  },\r\n  br: {\r\n    match: /<br\\b[^>]*\\/?>/gim,\r\n    replace: \" \",\r\n  },\r\n  html: {\r\n    // Removes all tags except inline text formatting\r\n    // \\b ensures word boundary (e.g., <i> is kept, but <img> is removed)\r\n    match: /(<((?!\\/?(?:b|strong|i|em|u|mark|small|sub|sup)\\b)[^>]+)>)/gi,\r\n    replace: \"\",\r\n  },\r\n};\r\n","import type { ShowMoreOptions } from \"./utils/defaults\";\r\nimport { defaultOptions, defaultRemoveElements } from \"./utils/defaults\";\r\nimport {\r\n  addRemoveClass,\r\n  createElement,\r\n  getNumber,\r\n  htmlSubstr,\r\n  removeElements,\r\n  setAttributes,\r\n} from \"./utils/function\";\r\nimport type { RegexConfig } from \"./utils/regex\";\r\nimport { defaultRegex } from \"./utils/regex\";\r\n\r\ninterface ShowMoreConfig {\r\n  onMoreLess?: (action: string, object: ShowMoreInternalObject) => void;\r\n  regex?: RegexConfig;\r\n  config?: Partial<ShowMoreOptions>;\r\n}\r\n\r\ninterface ShowMoreInternalObject extends ShowMoreOptions {\r\n  index: number;\r\n  classArray: DOMTokenList;\r\n  element: HTMLElement;\r\n  originalText?: string;\r\n  truncatedText?: string;\r\n  target?: EventTarget;\r\n}\r\n\r\n/**\r\n * ShowMore - JavaScript library that truncates text, list or table by chars, elements or rows\r\n */\r\nexport default class ShowMore {\r\n  private _onMoreLess: (action: string, object: ShowMoreInternalObject) => void;\r\n  private _regex: RegexConfig;\r\n  private _object!: ShowMoreInternalObject;\r\n  private _checkExp = false;\r\n\r\n  /**\r\n   * Constructor\r\n   *\r\n   * @param className - CSS selector for elements\r\n   * @param config - Configuration object\r\n   */\r\n  constructor(className: string, config: ShowMoreConfig = {}) {\r\n    const { onMoreLess = () => {}, regex = {}, config: globalConfig } = config;\r\n\r\n    // all html elements\r\n    const elements = Array.from(\r\n      document.querySelectorAll<HTMLElement>(className),\r\n    );\r\n\r\n    // callback function\r\n    this._onMoreLess = onMoreLess;\r\n\r\n    // global regex\r\n    this._regex = { ...defaultRegex, ...regex };\r\n\r\n    elements.forEach((item, index) => {\r\n      const configDataAttr = item.getAttribute(\"data-config\");\r\n      const configData = configDataAttr ? JSON.parse(configDataAttr) : {};\r\n\r\n      const configDataAndGlobal = { ...globalConfig, ...configData };\r\n\r\n      this._object = {\r\n        index,\r\n        classArray: item.classList,\r\n        ...defaultOptions,\r\n        ...configDataAndGlobal,\r\n        typeElement: configDataAndGlobal.element || \"span\",\r\n        element: item,\r\n      } as ShowMoreInternalObject;\r\n\r\n      this._initial();\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Initial function\r\n   */\r\n  private _initial = (): void => {\r\n    const {\r\n      element,\r\n      after = 0,\r\n      ellipsis,\r\n      nobutton,\r\n      limit = 0,\r\n      type,\r\n    } = this._object;\r\n    // set default aria-expanded to false\r\n    setAttributes(element, { \"showmore-expanded\": \"false\" });\r\n\r\n    const limitCounts = limit + after;\r\n    const ellips = ellipsis === false ? \"\" : \"...\";\r\n\r\n    // text\r\n    if (type === \"text\") {\r\n      const originalText = element.innerHTML.trim();\r\n      const elementText = element.textContent?.trim() || \"\";\r\n\r\n      if (elementText.length > limitCounts) {\r\n        // Remove unwanted elements (with their content) based on config\r\n        const elementsToRemove = this._object.removeElements || [];\r\n        let orgTexReg = removeElements(originalText, elementsToRemove);\r\n\r\n        // Check if removeElements is customized (different from default)\r\n        const isCustomRemoveElements =\r\n          JSON.stringify(elementsToRemove) !==\r\n          JSON.stringify(defaultRemoveElements);\r\n\r\n        // Apply regex rules for remaining tags\r\n        for (const rule of Object.values(this._regex)) {\r\n          if (rule?.match) {\r\n            // Skip 'html' regex if user has custom removeElements\r\n            // (user controls what to remove via removeElements)\r\n            if (isCustomRemoveElements && rule === this._regex.html) {\r\n              continue;\r\n            }\r\n            orgTexReg = orgTexReg.replace(rule.match, rule.replace);\r\n          }\r\n        }\r\n\r\n        const truncatedText = htmlSubstr(orgTexReg, limit - 1).concat(ellips);\r\n\r\n        element.textContent = \"\";\r\n        element.insertAdjacentHTML(\"beforeend\", truncatedText);\r\n\r\n        this._clickEvent(element, {\r\n          ...this._object,\r\n          originalText,\r\n          truncatedText,\r\n        });\r\n\r\n        if (!nobutton) {\r\n          this._addBtn(this._object);\r\n        }\r\n      }\r\n      return;\r\n    }\r\n\r\n    // list and table\r\n    if (type === \"list\" || type === \"table\") {\r\n      const items = this._getNumberCount(element, type);\r\n\r\n      if (items.length > limitCounts) {\r\n        // Optimize: iterate only from limit to end\r\n        for (let i = limit; i < items.length; i++) {\r\n          addRemoveClass(items[i], true);\r\n        }\r\n\r\n        if (!nobutton) {\r\n          this._addBtn(this._object);\r\n        }\r\n\r\n        // add event click\r\n        this._clickEvent(\r\n          type === \"list\"\r\n            ? element\r\n            : (element.nextElementSibling as HTMLElement),\r\n          this._object,\r\n        );\r\n      }\r\n    }\r\n  };\r\n\r\n  /**\r\n   * Event click\r\n   *\r\n   * @param element - HTMLElement to attach event to\r\n   * @param object - Configuration object\r\n   */\r\n  private _clickEvent = (\r\n    element: HTMLElement | null,\r\n    object: ShowMoreInternalObject,\r\n  ): void => {\r\n    if (!element) return;\r\n    element.addEventListener(\"click\", this._handleEvent.bind(this, object));\r\n  };\r\n\r\n  /**\r\n   * Create button\r\n   *\r\n   * @param config - Configuration object\r\n   * @returns HTMLButtonElement\r\n   */\r\n  private _createBtn = (config: ShowMoreInternalObject): HTMLButtonElement => {\r\n    const { element, number, less, more, type, btnClass, btnClassAppend } =\r\n      config;\r\n\r\n    const typeAria = this._checkExp ? less || \"\" : more || \"\";\r\n    let label = this._checkExp\r\n      ? (less as string).trim() || \"collapse\"\r\n      : (more as string).trim() || \"expand\";\r\n\r\n    // Optimize: cache getNumber result\r\n    const numberText = number ? getNumber(element, type || \"\") : \"\";\r\n    label = number ? label + numberText : label;\r\n\r\n    const button = createElement(\"button\");\r\n\r\n    button.className =\r\n      btnClassAppend == null ? btnClass : `${btnClass} ${btnClassAppend}`;\r\n    setAttributes(button, {\r\n      \"aria-expanded\": this._checkExp,\r\n      \"aria-label\": label,\r\n      tabindex: 0,\r\n    });\r\n\r\n    // Use cached numberText\r\n    button.insertAdjacentHTML(\r\n      \"beforeend\",\r\n      number ? typeAria + numberText : typeAria,\r\n    );\r\n\r\n    return button;\r\n  };\r\n\r\n  /**\r\n   * Event handler\r\n   *\r\n   * @param object - Configuration object\r\n   * @param event - Mouse event\r\n   */\r\n  private _handleEvent = (\r\n    object: ShowMoreInternalObject,\r\n    event: MouseEvent,\r\n  ): void => {\r\n    const { target } = event;\r\n    if (!(target instanceof HTMLElement)) return;\r\n\r\n    const {\r\n      element,\r\n      type,\r\n      limit = 0,\r\n      less,\r\n      typeElement,\r\n      originalText,\r\n      truncatedText,\r\n      btnClass,\r\n    } = object;\r\n\r\n    // check if the button is clicked\r\n    if (!target.classList.contains(btnClass)) return;\r\n\r\n    const showMoreExpanded = element.getAttribute(\"showmore-expanded\");\r\n    this._checkExp = showMoreExpanded === \"false\";\r\n\r\n    // --------------------------------------------------\r\n    // text\r\n    if (type === \"text\") {\r\n      element.textContent = \"\";\r\n\r\n      element.insertAdjacentHTML(\r\n        \"beforeend\",\r\n        this._checkExp ? originalText || \"\" : truncatedText || \"\",\r\n      );\r\n\r\n      if (less) {\r\n        const el = createElement(typeElement as keyof HTMLElementTagNameMap);\r\n        el.classList.add(\"show-more-wrapper\");\r\n        const btn = this._createBtn(object);\r\n        if (btn) el.insertAdjacentElement(\"beforeend\", btn);\r\n        element.appendChild(el);\r\n      }\r\n    }\r\n\r\n    // --------------------------------------------------\r\n    // list and table\r\n    if (type === \"list\" || type === \"table\") {\r\n      const items = this._getNumberCount(element, type);\r\n      const isExpanding = showMoreExpanded === \"false\";\r\n\r\n      if (isExpanding) {\r\n        // Show all: remove hidden class from all\r\n        for (let i = limit; i < items.length; i++) {\r\n          addRemoveClass(items[i], false);\r\n        }\r\n      } else {\r\n        // Hide: add hidden class from limit to end\r\n        const endIndex = type === \"list\" ? items.length - 1 : items.length;\r\n        for (let i = limit; i < endIndex; i++) {\r\n          addRemoveClass(items[i], true);\r\n        }\r\n      }\r\n    }\r\n\r\n    // set aria-expanded\r\n    if (type) {\r\n      this._setExpand({ ...object, target });\r\n    }\r\n  };\r\n\r\n  /**\r\n   * Get number count based on type\r\n   */\r\n  private _getNumberCount = (\r\n    element: HTMLElement,\r\n    type: string,\r\n  ): HTMLElement[] | HTMLCollectionOf<HTMLTableRowElement> => {\r\n    if (type === \"list\") {\r\n      return Array.from(element.children) as HTMLElement[];\r\n    }\r\n    return (element as HTMLTableElement).rows;\r\n  };\r\n\r\n  /**\r\n   * Add button\r\n   *\r\n   * @param object - Configuration object\r\n   */\r\n  private _addBtn = (object: ShowMoreInternalObject): void => {\r\n    const { type, element, more, typeElement } = object;\r\n\r\n    if (!more) return;\r\n\r\n    if (type === \"table\") {\r\n      element.insertAdjacentElement(\"afterend\", this._createBtn(object));\r\n    } else {\r\n      const el = createElement(typeElement as keyof HTMLElementTagNameMap);\r\n      el.classList.add(\"show-more-wrapper\");\r\n      el.appendChild(this._createBtn(object));\r\n      element.appendChild(el);\r\n    }\r\n  };\r\n\r\n  /**\r\n   * Set aria-expanded\r\n   *\r\n   * @param object - Configuration object with target\r\n   */\r\n  private _setExpand = (\r\n    object: ShowMoreInternalObject & { target: EventTarget },\r\n  ): void => {\r\n    const { element, type, less, more, number, target } = object;\r\n\r\n    if (!(target instanceof HTMLElement)) return;\r\n\r\n    const typeAria = this._checkExp ? less : more;\r\n    const aria = this._checkExp ? \"expand\" : \"collapse\";\r\n    const lastChild = element.lastElementChild;\r\n\r\n    // Optimize: cache getNumber result\r\n    const numberText = number ? getNumber(element, type || \"\") : \"\";\r\n    const ariaLabel = number ? typeAria + numberText : typeAria;\r\n\r\n    setAttributes(element, { \"showmore-expanded\": this._checkExp });\r\n    setAttributes(target, {\r\n      \"aria-expanded\": this._checkExp,\r\n      \"aria-label\": ariaLabel,\r\n    });\r\n\r\n    // callback function on more/less\r\n    this._onMoreLess(aria, object);\r\n\r\n    if (typeAria) {\r\n      // Use cached numberText\r\n      target.innerHTML = number ? typeAria + numberText : typeAria;\r\n    } else if (type === \"table\") {\r\n      target.parentNode?.removeChild(target);\r\n    } else if (type === \"list\" && lastChild?.parentNode) {\r\n      lastChild.parentNode.removeChild(lastChild);\r\n    }\r\n  };\r\n}\r\n"],"names":["defaultRemoveElements","defaultOptions","typeElement","more","less","number","nobutton","after","btnClass","btnClassAppend","removeElements","getNumber","element","type","elementType","rows","children","numbersElementHidden","Array","from","filter","el","classList","contains","length","htmlSubstr","originalText","count","div","createElement","insertAdjacentHTML","remaining","walk","fn","node","firstChild","nodeType","childNodes","nextSibling","len","data","substringData","querySelectorAll","forEach","table","row","cells","every","cell","textContent","trim","remove","cleanupTableRows","html","prev","cleaned","replace","removeEmptyTags","innerHTML","addRemoveClass","setAttributes","attributes","key","setAttribute","String","document","defaultRegex","newLine","match","space","br","constructor","className","config","_checkExp","this","_initial","ellipsis","limit","_object","limitCounts","ellips","elementsToRemove","orgTexReg","tags","tag","isCustomRemoveElements","JSON","stringify","rule","Object","values","_regex","truncatedText","concat","_clickEvent","_addBtn","items","_getNumberCount","i","nextElementSibling","object","addEventListener","_handleEvent","bind","_createBtn","typeAria","label","numberText","button","tabindex","event","target","HTMLElement","showMoreExpanded","getAttribute","add","btn","insertAdjacentElement","appendChild","endIndex","_setExpand","aria","lastChild","lastElementChild","ariaLabel","_onMoreLess","parentNode","removeChild","onMoreLess","regex","globalConfig","elements","item","index","configDataAttr","configData","parse","configDataAndGlobal","classArray"],"mappings":"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"}