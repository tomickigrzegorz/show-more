{"version":3,"file":"showMore.js","sources":["../../sources/utils/defaults.ts","../../sources/utils/function.ts","../../sources/utils/regex.ts","../../sources/index.ts"],"sourcesContent":["export interface ShowMoreOptions {\r\n  typeElement: string;\r\n  more: string | false;\r\n  less: string | false;\r\n  number: boolean;\r\n  nobutton: boolean;\r\n  after: number;\r\n  btnClass: string;\r\n  btnClassAppend: string | null;\r\n  limit?: number;\r\n  type?: \"text\" | \"list\" | \"table\";\r\n  element?: HTMLElement;\r\n  ellipsis?: boolean | string;\r\n}\r\n\r\nexport const defaultOptions: Partial<ShowMoreOptions> = {\r\n  typeElement: \"span\",\r\n  more: false,\r\n  less: false,\r\n  number: false,\r\n  nobutton: false,\r\n  after: 0,\r\n  btnClass: \"show-more-btn\",\r\n  btnClassAppend: null,\r\n};\r\n","/**\r\n * Get hidden element count\r\n *\r\n * @param element - HTMLElement with rows or children\r\n * @param type - type of element table | list\r\n * @returns string with count or empty string\r\n */\r\nexport const getNumber = (\r\n  element: {\r\n    rows?: HTMLCollectionOf<HTMLTableRowElement>;\r\n    children?: HTMLCollection;\r\n  },\r\n  type: string,\r\n): string => {\r\n  const elementType = type === \"table\" ? element.rows : element.children;\r\n\r\n  if (!elementType) return \"\";\r\n\r\n  const numbersElementHidden = Array.from(elementType).filter((el) =>\r\n    el.classList.contains(\"hidden\"),\r\n  ).length;\r\n  return numbersElementHidden !== 0 ? ` ${numbersElementHidden}` : \"\";\r\n};\r\n\r\n// https://stackoverflow.com/questions/6003271/substring-text-with-html-tags-in-javascript\r\n/**\r\n * Substring text with html tags\r\n *\r\n * @param originalText - text with html tags\r\n * @param count - limit of characters\r\n * @returns truncated html string\r\n */\r\nexport const htmlSubstr = (originalText: string, count: number): string => {\r\n  const div = createElement(\"div\");\r\n  div.insertAdjacentHTML(\"afterbegin\", originalText);\r\n\r\n  let remaining = count;\r\n\r\n  walk(div, track);\r\n\r\n  function track(el: Text): void {\r\n    if (remaining > 0) {\r\n      const len = el.data.length;\r\n      remaining -= len;\r\n      if (remaining <= 0) {\r\n        el.data = el.substringData(0, el.data.length + remaining);\r\n      }\r\n    } else {\r\n      el.data = \"\";\r\n    }\r\n  }\r\n\r\n  function walk(el: Node, fn: (node: Text) => void): void {\r\n    let node = el.firstChild;\r\n    while (node) {\r\n      if (node.nodeType === 3) {\r\n        fn(node as Text);\r\n      } else if (node.nodeType === 1 && node.childNodes && node.childNodes[0]) {\r\n        walk(node, fn);\r\n      }\r\n      node = node.nextSibling;\r\n    }\r\n  }\r\n  return div.innerHTML;\r\n};\r\n\r\n/**\r\n * Add/remove class 'hidden' to element\r\n *\r\n * @param element - HTMLElement to modify\r\n * @param type - true to add, false to remove\r\n */\r\nexport const addRemoveClass = (element: Element, type = false): void => {\r\n  element.classList[type ? \"add\" : \"remove\"](\"hidden\");\r\n};\r\n\r\n/**\r\n * Set attributes to element\r\n *\r\n * @param el - HTMLElement to set attributes on\r\n * @param attributes - object with attribute key-value pairs\r\n */\r\nexport const setAttributes = (\r\n  el: HTMLElement,\r\n  attributes: Record<string, string | number | boolean>,\r\n): void => {\r\n  for (const key in attributes) {\r\n    el.setAttribute(key, String(attributes[key]));\r\n  }\r\n};\r\n\r\n/**\r\n * Create element\r\n *\r\n * @param type - type of element to create\r\n * @returns created HTMLElement\r\n */\r\nexport const createElement = <K extends keyof HTMLElementTagNameMap>(\r\n  type: K,\r\n): HTMLElementTagNameMap[K] => document.createElement(type);\r\n","export interface RegexRule {\r\n  match: RegExp;\r\n  replace: string;\r\n}\r\n\r\nexport interface RegexConfig {\r\n  newLine?: RegexRule;\r\n  space?: RegexRule;\r\n  br?: RegexRule;\r\n  html?: RegexRule;\r\n  [key: string]: RegexRule | undefined;\r\n}\r\n\r\n/**\r\n * Default regexes for validation\r\n */\r\nexport const defaultRegex: RegexConfig = {\r\n  newLine: {\r\n    match: /(\\r\\n|\\n|\\r)/gm,\r\n    replace: \" \",\r\n  },\r\n  space: {\r\n    match: /\\s\\s+/gm,\r\n    replace: \" \",\r\n  },\r\n  br: {\r\n    match: /<br\\b[^>]*\\/?>/gim,\r\n    replace: \" \",\r\n  },\r\n  html: {\r\n    match: /(<((?!b|\\/b|!strong|\\/strong)[^>]+)>)/gi,\r\n    replace: \"\",\r\n  },\r\n};\r\n","import type { ShowMoreOptions } from \"./utils/defaults\";\r\nimport { defaultOptions } from \"./utils/defaults\";\r\nimport {\r\n  addRemoveClass,\r\n  createElement,\r\n  getNumber,\r\n  htmlSubstr,\r\n  setAttributes,\r\n} from \"./utils/function\";\r\nimport type { RegexConfig } from \"./utils/regex\";\r\nimport { defaultRegex } from \"./utils/regex\";\r\n\r\ninterface ShowMoreConfig {\r\n  onMoreLess?: (action: string, object: ShowMoreInternalObject) => void;\r\n  regex?: RegexConfig;\r\n  config?: Partial<ShowMoreOptions>;\r\n}\r\n\r\ninterface ShowMoreInternalObject extends ShowMoreOptions {\r\n  index: number;\r\n  classArray: DOMTokenList;\r\n  element: HTMLElement;\r\n  originalText?: string;\r\n  truncatedText?: string;\r\n  target?: EventTarget;\r\n}\r\n\r\n/**\r\n * ShowMore - JavaScript library that truncates text, list or table by chars, elements or rows\r\n */\r\nexport default class ShowMore {\r\n  private _onMoreLess: (action: string, object: ShowMoreInternalObject) => void;\r\n  private _regex: RegexConfig;\r\n  private _object!: ShowMoreInternalObject;\r\n  private _checkExp = false;\r\n\r\n  /**\r\n   * Constructor\r\n   *\r\n   * @param className - CSS selector for elements\r\n   * @param config - Configuration object\r\n   */\r\n  constructor(className: string, config: ShowMoreConfig = {}) {\r\n    const { onMoreLess = () => {}, regex = {}, config: globalConfig } = config;\r\n\r\n    // all html elements\r\n    const elements = Array.from(\r\n      document.querySelectorAll<HTMLElement>(className),\r\n    );\r\n\r\n    // callback function\r\n    this._onMoreLess = onMoreLess;\r\n\r\n    // global regex\r\n    this._regex = { ...defaultRegex, ...regex };\r\n\r\n    elements.forEach((item, index) => {\r\n      const configDataAttr = item.getAttribute(\"data-config\");\r\n      const configData = configDataAttr ? JSON.parse(configDataAttr) : {};\r\n\r\n      const configDataAndGlobal = { ...globalConfig, ...configData };\r\n\r\n      this._object = {\r\n        index,\r\n        classArray: item.classList,\r\n        ...defaultOptions,\r\n        ...configDataAndGlobal,\r\n        typeElement: configDataAndGlobal.element || \"span\",\r\n        element: item,\r\n      } as ShowMoreInternalObject;\r\n\r\n      this._initial();\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Initial function\r\n   */\r\n  private _initial = (): void => {\r\n    const {\r\n      element,\r\n      after = 0,\r\n      ellipsis,\r\n      nobutton,\r\n      limit = 0,\r\n      type,\r\n    } = this._object;\r\n    // set default aria-expanded to false\r\n    setAttributes(element, { \"showmore-expanded\": \"false\" });\r\n\r\n    const limitCounts = limit + after;\r\n    const ellips = ellipsis === false ? \"\" : \"...\";\r\n\r\n    // text\r\n    if (type === \"text\") {\r\n      const originalText = element.innerHTML.trim();\r\n      const elementText = element.textContent?.trim() || \"\";\r\n\r\n      if (elementText.length > limitCounts) {\r\n        let orgTexReg = originalText;\r\n\r\n        for (const key in this._regex) {\r\n          const rule = this._regex[key];\r\n          if (rule && key) {\r\n            const { match, replace } = rule;\r\n            if (match) orgTexReg = orgTexReg.replace(match, replace);\r\n          }\r\n        }\r\n\r\n        const truncatedText = htmlSubstr(orgTexReg, limit - 1).concat(ellips);\r\n\r\n        element.textContent = \"\";\r\n        element.insertAdjacentHTML(\"beforeend\", truncatedText);\r\n\r\n        this._clickEvent(element, {\r\n          ...this._object,\r\n          originalText,\r\n          truncatedText,\r\n        });\r\n\r\n        if (nobutton) return;\r\n        this._addBtn(this._object);\r\n      }\r\n    }\r\n\r\n    // list and table\r\n    if (type === \"list\" || type === \"table\") {\r\n      const items = this._getNumberCount(element, type);\r\n\r\n      if (items.length > limitCounts) {\r\n        for (let i = limit; i < items.length; i++) {\r\n          addRemoveClass(items[i], true);\r\n        }\r\n\r\n        if (!nobutton) {\r\n          // add button to the list and table\r\n          this._addBtn(this._object);\r\n        }\r\n\r\n        // add event click\r\n        this._clickEvent(\r\n          type === \"list\"\r\n            ? element\r\n            : (element.nextElementSibling as HTMLElement),\r\n          this._object,\r\n        );\r\n\r\n        if (nobutton) return;\r\n      }\r\n    }\r\n  };\r\n\r\n  /**\r\n   * Event click\r\n   *\r\n   * @param element - HTMLElement to attach event to\r\n   * @param object - Configuration object\r\n   */\r\n  private _clickEvent = (\r\n    element: HTMLElement | null,\r\n    object: ShowMoreInternalObject,\r\n  ): void => {\r\n    if (!element) return;\r\n    element.addEventListener(\"click\", this._handleEvent.bind(this, object));\r\n  };\r\n\r\n  /**\r\n   * Create button\r\n   *\r\n   * @param config - Configuration object\r\n   * @returns HTMLButtonElement\r\n   */\r\n  private _createBtn = (config: ShowMoreInternalObject): HTMLButtonElement => {\r\n    const { element, number, less, more, type, btnClass, btnClassAppend } =\r\n      config;\r\n\r\n    const typeAria = this._checkExp ? less || \"\" : more || \"\";\r\n    let label = this._checkExp\r\n      ? (less as string).trim() || \"collapse\"\r\n      : (more as string).trim() || \"expand\";\r\n\r\n    label = number ? label + getNumber(element, type || \"\") : label;\r\n\r\n    const expanded = !!this._checkExp;\r\n\r\n    const button = createElement(\"button\");\r\n\r\n    button.className =\r\n      btnClassAppend == null ? btnClass : `${btnClass} ${btnClassAppend}`;\r\n    setAttributes(button, {\r\n      \"aria-expanded\": expanded,\r\n      \"aria-label\": label,\r\n      tabindex: 0,\r\n    });\r\n\r\n    button.insertAdjacentHTML(\r\n      \"beforeend\",\r\n      number ? typeAria + getNumber(element, type || \"\") : typeAria,\r\n    );\r\n\r\n    return button;\r\n  };\r\n\r\n  /**\r\n   * Event handler\r\n   *\r\n   * @param object - Configuration object\r\n   * @param event - Mouse event\r\n   */\r\n  private _handleEvent = (\r\n    object: ShowMoreInternalObject,\r\n    event: MouseEvent,\r\n  ): void => {\r\n    const { target } = event;\r\n    if (!(target instanceof HTMLElement)) return;\r\n\r\n    const {\r\n      element,\r\n      type,\r\n      limit = 0,\r\n      less,\r\n      typeElement,\r\n      originalText,\r\n      truncatedText,\r\n      btnClass,\r\n    } = object;\r\n\r\n    // check if the button is clicked\r\n    const checkContainsClass = target.classList.contains(btnClass);\r\n\r\n    if (!checkContainsClass) return;\r\n\r\n    const showMoreExpanded = element.getAttribute(\"showmore-expanded\");\r\n    this._checkExp = showMoreExpanded === \"false\";\r\n\r\n    // --------------------------------------------------\r\n    // text\r\n    if (type === \"text\" && checkContainsClass) {\r\n      element.textContent = \"\";\r\n\r\n      element.insertAdjacentHTML(\r\n        \"beforeend\",\r\n        this._checkExp ? originalText || \"\" : truncatedText || \"\",\r\n      );\r\n\r\n      if (less) {\r\n        const el = createElement(typeElement as keyof HTMLElementTagNameMap);\r\n        el.classList.add(\"show-more-wrapper\");\r\n        const btn = this._createBtn(object);\r\n        if (btn) el.insertAdjacentElement(\"beforeend\", btn);\r\n        element.appendChild(el);\r\n      }\r\n    }\r\n\r\n    // --------------------------------------------------\r\n    // list and table\r\n    if (type === \"list\" || type === \"table\") {\r\n      const items = this._getNumberCount(element, type);\r\n\r\n      for (let i = 0; i < items.length; i++) {\r\n        const typeRemove =\r\n          type === \"list\" ? i >= limit && i < items.length - 1 : i >= limit;\r\n\r\n        if (showMoreExpanded === \"false\") {\r\n          addRemoveClass(items[i]);\r\n        } else if (typeRemove) {\r\n          addRemoveClass(items[i], true);\r\n        }\r\n      }\r\n    }\r\n\r\n    // set aria-expanded\r\n    if (type) {\r\n      this._setExpand({ ...object, target });\r\n    }\r\n  };\r\n\r\n  /**\r\n   * Get number count based on type\r\n   */\r\n  private _getNumberCount = (\r\n    element: HTMLElement,\r\n    type: string,\r\n  ): HTMLElement[] | HTMLCollectionOf<HTMLTableRowElement> => {\r\n    if (type === \"list\") {\r\n      return Array.from(element.children) as HTMLElement[];\r\n    }\r\n    return (element as HTMLTableElement).rows;\r\n  };\r\n\r\n  /**\r\n   * Add button\r\n   *\r\n   * @param object - Configuration object\r\n   */\r\n  private _addBtn = (object: ShowMoreInternalObject): void => {\r\n    const { type, element, more, typeElement } = object;\r\n\r\n    if (!more) return;\r\n\r\n    if (type === \"table\") {\r\n      element.insertAdjacentElement(\"afterend\", this._createBtn(object));\r\n    } else {\r\n      const el = createElement(typeElement as keyof HTMLElementTagNameMap);\r\n      el.classList.add(\"show-more-wrapper\");\r\n      el.appendChild(this._createBtn(object));\r\n      element.appendChild(el);\r\n    }\r\n  };\r\n\r\n  /**\r\n   * Set aria-expanded\r\n   *\r\n   * @param object - Configuration object with target\r\n   */\r\n  private _setExpand = (\r\n    object: ShowMoreInternalObject & { target: EventTarget },\r\n  ): void => {\r\n    const { element, type, less, more, number, target } = object;\r\n\r\n    if (!(target instanceof HTMLElement)) return;\r\n\r\n    const typeAria = this._checkExp ? less : more;\r\n    const aria = this._checkExp ? \"expand\" : \"collapse\";\r\n    const lastChild = element.lastElementChild;\r\n\r\n    const ariaLabel = number\r\n      ? typeAria + getNumber(element, type || \"\")\r\n      : typeAria;\r\n\r\n    setAttributes(element, { \"showmore-expanded\": this._checkExp });\r\n    setAttributes(target, {\r\n      \"aria-expanded\": this._checkExp,\r\n      \"aria-label\": ariaLabel,\r\n    });\r\n\r\n    // callback function on more/less\r\n    this._onMoreLess(aria, object);\r\n\r\n    if (typeAria) {\r\n      target.innerHTML = number\r\n        ? typeAria + getNumber(element, type || \"\")\r\n        : typeAria;\r\n    } else if (type === \"table\") {\r\n      target.parentNode?.removeChild(target);\r\n    } else if (type === \"list\" && lastChild?.parentNode) {\r\n      lastChild.parentNode.removeChild(lastChild);\r\n    }\r\n  };\r\n}\r\n"],"names":["defaultOptions","typeElement","more","less","number","nobutton","after","btnClass","btnClassAppend","getNumber","element","type","elementType","rows","children","numbersElementHidden","Array","from","filter","el","classList","contains","length","htmlSubstr","originalText","count","div","createElement","insertAdjacentHTML","remaining","walk","track","len","data","substringData","fn","node","firstChild","nodeType","childNodes","nextSibling","innerHTML","addRemoveClass","setAttributes","attributes","key","setAttribute","String","document","defaultRegex","newLine","match","replace","space","br","html","ShowMore","className","config","_checkExp","_initial","ellipsis","limit","_object","limitCounts","ellips","trim","elementText","textContent","orgTexReg","_regex","rule","truncatedText","concat","_clickEvent","_addBtn","items","_getNumberCount","i","nextElementSibling","object","addEventListener","_handleEvent","bind","_createBtn","typeAria","label","expanded","button","tabindex","event","target","HTMLElement","checkContainsClass","showMoreExpanded","getAttribute","add","btn","insertAdjacentElement","appendChild","typeRemove","_setExpand","aria","lastChild","lastElementChild","ariaLabel","_onMoreLess","parentNode","removeChild","onMoreLess","regex","globalConfig","elements","querySelectorAll","forEach","item","index","configDataAttr","configData","JSON","parse","configDataAndGlobal","classArray"],"mappings":"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"}