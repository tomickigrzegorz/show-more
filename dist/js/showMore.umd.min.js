!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t="undefined"!=typeof globalThis?globalThis:t||self).ShowMore=e()}(this,function(){"use strict";const t={typeElement:"span",more:!1,less:!1,number:!1,nobutton:!1,after:0,btnClass:"show-more-btn",btnClassAppend:null},e=(t,e)=>{const s="table"===e?t.rows:t.children;if(!s)return"";const n=Array.from(s).filter(t=>t.classList.contains("hidden")).length;return 0!==n?` ${n}`:""},s=(t,e=!1)=>{t.classList[e?"add":"remove"]("hidden")},n=(t,e)=>{for(const s in e)t.setAttribute(s,String(e[s]))},i=t=>document.createElement(t),o={newLine:{match:/(\r\n|\n|\r)/gm,replace:" "},space:{match:/\s\s+/gm,replace:" "},br:{match:/<br\b[^>]*\/?>/gim,replace:" "},html:{match:/(<((?!b|\/b|!strong|\/strong)[^>]+)>)/gi,replace:""}};return class{constructor(r,l={}){this.t=!1,this.i=()=>{const{element:t,after:e=0,ellipsis:o,nobutton:r,limit:l=0,type:a}=this.o;n(t,{"showmore-expanded":"false"});const c=l+e,h=!1===o?"":"...";if("text"===a){const e=t.innerHTML.trim();if((t.textContent?.trim()||"").length>c){let s=e;for(const t of Object.values(this.l))t?.match&&(s=s.replace(t.match,t.replace));const n=((t,e)=>{const s=i("div");s.insertAdjacentHTML("afterbegin",t);let n=e;return function t(e,s){let n=e.firstChild;for(;n;)3===n.nodeType?s(n):1===n.nodeType&&n.childNodes&&n.childNodes[0]&&t(n,s),n=n.nextSibling}(s,function(t){if(n>0){const e=t.data.length;n-=e,n<=0&&(t.data=t.substringData(0,t.data.length+n))}else t.data=""}),s.innerHTML})(s,l-1).concat(h);t.textContent="",t.insertAdjacentHTML("beforeend",n),this.h(t,{...this.o,originalText:e,truncatedText:n}),r||this.m(this.o)}return}if("list"===a||"table"===a){const e=this.p(t,a);if(e.length>c){for(let t=l;t<e.length;t++)s(e[t],!0);r||this.m(this.o),this.h("list"===a?t:t.nextElementSibling,this.o)}}},this.h=(t,e)=>{t&&t.addEventListener("click",this.u.bind(this,e))},this.T=t=>{const{element:s,number:o,less:r,more:l,type:a,btnClass:c,btnClassAppend:h}=t,f=this.t?r||"":l||"";let d=this.t?r.trim()||"collapse":l.trim()||"expand";const m=o?e(s,a||""):"";d=o?d+m:d;const p=i("button");return p.className=null==h?c:`${c} ${h}`,n(p,{"aria-expanded":this.t,"aria-label":d,tabindex:0}),p.insertAdjacentHTML("beforeend",o?f+m:f),p},this.u=(t,e)=>{const{target:n}=e;if(!(n instanceof HTMLElement))return;const{element:o,type:r,limit:l=0,less:a,typeElement:c,originalText:h,truncatedText:f,btnClass:d}=t;if(!n.classList.contains(d))return;const m=o.getAttribute("showmore-expanded");if(this.t="false"===m,"text"===r&&(o.textContent="",o.insertAdjacentHTML("beforeend",this.t?h||"":f||""),a)){const e=i(c);e.classList.add("show-more-wrapper");const s=this.T(t);s&&e.insertAdjacentElement("beforeend",s),o.appendChild(e)}if("list"===r||"table"===r){const t=this.p(o,r);if("false"===m)for(let e=l;e<t.length;e++)s(t[e],!1);else{const e="list"===r?t.length-1:t.length;for(let n=l;n<e;n++)s(t[n],!0)}}r&&this.A({...t,target:n})},this.p=(t,e)=>"list"===e?Array.from(t.children):t.rows,this.m=t=>{const{type:e,element:s,more:n,typeElement:o}=t;if(n)if("table"===e)s.insertAdjacentElement("afterend",this.T(t));else{const e=i(o);e.classList.add("show-more-wrapper"),e.appendChild(this.T(t)),s.appendChild(e)}},this.A=t=>{const{element:s,type:i,less:o,more:r,number:l,target:a}=t;if(!(a instanceof HTMLElement))return;const c=this.t?o:r,h=this.t?"expand":"collapse",f=s.lastElementChild,d=l?e(s,i||""):"",m=l?c+d:c;n(s,{"showmore-expanded":this.t}),n(a,{"aria-expanded":this.t,"aria-label":m}),this.C(h,t),c?a.innerHTML=l?c+d:c:"table"===i?a.parentNode?.removeChild(a):"list"===i&&f?.parentNode&&f.parentNode.removeChild(f)};const{onMoreLess:a=()=>{},regex:c={},config:h}=l,f=Array.from(document.querySelectorAll(r));this.C=a,this.l={...o,...c},f.forEach((e,s)=>{const n=e.getAttribute("data-config"),i=n?JSON.parse(n):{},o={...h,...i};this.o={index:s,classArray:e.classList,...t,...o,typeElement:o.element||"span",element:e},this.i()})}}});
