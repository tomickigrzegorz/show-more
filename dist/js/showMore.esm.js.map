{"version":3,"file":"showMore.esm.js","sources":["../../sources/utils/defaults.ts","../../sources/utils/function.ts","../../sources/utils/regex.ts","../../sources/index.ts"],"sourcesContent":["export interface ShowMoreOptions {\r\n  typeElement: string;\r\n  more: string | false;\r\n  less: string | false;\r\n  number: boolean;\r\n  nobutton: boolean;\r\n  after: number;\r\n  btnClass: string;\r\n  btnClassAppend: string | null;\r\n  limit?: number;\r\n  type?: \"text\" | \"list\" | \"table\";\r\n  element?: HTMLElement;\r\n  ellipsis?: boolean | string;\r\n}\r\n\r\nexport const defaultOptions: Partial<ShowMoreOptions> = {\r\n  typeElement: \"span\",\r\n  more: false,\r\n  less: false,\r\n  number: false,\r\n  nobutton: false,\r\n  after: 0,\r\n  btnClass: \"show-more-btn\",\r\n  btnClassAppend: null,\r\n};\r\n","/**\r\n * Get hidden element count\r\n *\r\n * @param element - HTMLElement with rows or children\r\n * @param type - type of element table | list\r\n * @returns string with count or empty string\r\n */\r\nexport const getNumber = (\r\n  element: {\r\n    rows?: HTMLCollectionOf<HTMLTableRowElement>;\r\n    children?: HTMLCollection;\r\n  },\r\n  type: string,\r\n): string => {\r\n  const elementType = type === \"table\" ? element.rows : element.children;\r\n\r\n  if (!elementType) return \"\";\r\n\r\n  const numbersElementHidden = Array.from(elementType).filter((el) =>\r\n    el.classList.contains(\"hidden\"),\r\n  ).length;\r\n  return numbersElementHidden !== 0 ? ` ${numbersElementHidden}` : \"\";\r\n};\r\n\r\n// https://stackoverflow.com/questions/6003271/substring-text-with-html-tags-in-javascript\r\n/**\r\n * Substring text with html tags\r\n *\r\n * @param originalText - text with html tags\r\n * @param count - limit of characters\r\n * @returns truncated html string\r\n */\r\nexport const htmlSubstr = (originalText: string, count: number): string => {\r\n  const div = createElement(\"div\");\r\n  div.insertAdjacentHTML(\"afterbegin\", originalText);\r\n\r\n  let remaining = count;\r\n\r\n  walk(div, track);\r\n\r\n  function track(el: Text): void {\r\n    if (remaining > 0) {\r\n      const len = el.data.length;\r\n      remaining -= len;\r\n      if (remaining <= 0) {\r\n        el.data = el.substringData(0, el.data.length + remaining);\r\n      }\r\n    } else {\r\n      el.data = \"\";\r\n    }\r\n  }\r\n\r\n  function walk(el: Node, fn: (node: Text) => void): void {\r\n    let node = el.firstChild;\r\n    while (node) {\r\n      if (node.nodeType === 3) {\r\n        fn(node as Text);\r\n      } else if (node.nodeType === 1 && node.childNodes && node.childNodes[0]) {\r\n        walk(node, fn);\r\n      }\r\n      node = node.nextSibling;\r\n    }\r\n  }\r\n  return div.innerHTML;\r\n};\r\n\r\n/**\r\n * Add/remove class 'hidden' to element\r\n *\r\n * @param element - HTMLElement to modify\r\n * @param type - true to add, false to remove\r\n */\r\nexport const addRemoveClass = (element: Element, type = false): void => {\r\n  element.classList[type ? \"add\" : \"remove\"](\"hidden\");\r\n};\r\n\r\n/**\r\n * Set attributes to element\r\n *\r\n * @param el - HTMLElement to set attributes on\r\n * @param attributes - object with attribute key-value pairs\r\n */\r\nexport const setAttributes = (\r\n  el: HTMLElement,\r\n  attributes: Record<string, string | number | boolean>,\r\n): void => {\r\n  for (const key in attributes) {\r\n    el.setAttribute(key, String(attributes[key]));\r\n  }\r\n};\r\n\r\n/**\r\n * Create element\r\n *\r\n * @param type - type of element to create\r\n * @returns created HTMLElement\r\n */\r\nexport const createElement = <K extends keyof HTMLElementTagNameMap>(\r\n  type: K,\r\n): HTMLElementTagNameMap[K] => document.createElement(type);\r\n","export interface RegexRule {\r\n  match: RegExp;\r\n  replace: string;\r\n}\r\n\r\nexport interface RegexConfig {\r\n  newLine?: RegexRule;\r\n  space?: RegexRule;\r\n  br?: RegexRule;\r\n  html?: RegexRule;\r\n  [key: string]: RegexRule | undefined;\r\n}\r\n\r\n/**\r\n * Default regexes for validation\r\n */\r\nexport const defaultRegex: RegexConfig = {\r\n  newLine: {\r\n    match: /(\\r\\n|\\n|\\r)/gm,\r\n    replace: \" \",\r\n  },\r\n  space: {\r\n    match: /\\s\\s+/gm,\r\n    replace: \" \",\r\n  },\r\n  br: {\r\n    match: /<br\\b[^>]*\\/?>/gim,\r\n    replace: \" \",\r\n  },\r\n  html: {\r\n    match: /(<((?!b|\\/b|!strong|\\/strong)[^>]+)>)/gi,\r\n    replace: \"\",\r\n  },\r\n};\r\n","import type { ShowMoreOptions } from \"./utils/defaults\";\r\nimport { defaultOptions } from \"./utils/defaults\";\r\nimport {\r\n  addRemoveClass,\r\n  createElement,\r\n  getNumber,\r\n  htmlSubstr,\r\n  setAttributes,\r\n} from \"./utils/function\";\r\nimport type { RegexConfig } from \"./utils/regex\";\r\nimport { defaultRegex } from \"./utils/regex\";\r\n\r\ninterface ShowMoreConfig {\r\n  onMoreLess?: (action: string, object: ShowMoreInternalObject) => void;\r\n  regex?: RegexConfig;\r\n  config?: Partial<ShowMoreOptions>;\r\n}\r\n\r\ninterface ShowMoreInternalObject extends ShowMoreOptions {\r\n  index: number;\r\n  classArray: DOMTokenList;\r\n  element: HTMLElement;\r\n  originalText?: string;\r\n  truncatedText?: string;\r\n  target?: EventTarget;\r\n}\r\n\r\n/**\r\n * ShowMore - JavaScript library that truncates text, list or table by chars, elements or rows\r\n */\r\nexport default class ShowMore {\r\n  private _onMoreLess: (action: string, object: ShowMoreInternalObject) => void;\r\n  private _regex: RegexConfig;\r\n  private _object!: ShowMoreInternalObject;\r\n  private _checkExp = false;\r\n\r\n  /**\r\n   * Constructor\r\n   *\r\n   * @param className - CSS selector for elements\r\n   * @param config - Configuration object\r\n   */\r\n  constructor(className: string, config: ShowMoreConfig = {}) {\r\n    const { onMoreLess = () => {}, regex = {}, config: globalConfig } = config;\r\n\r\n    // all html elements\r\n    const elements = Array.from(\r\n      document.querySelectorAll<HTMLElement>(className),\r\n    );\r\n\r\n    // callback function\r\n    this._onMoreLess = onMoreLess;\r\n\r\n    // global regex\r\n    this._regex = { ...defaultRegex, ...regex };\r\n\r\n    elements.forEach((item, index) => {\r\n      const configDataAttr = item.getAttribute(\"data-config\");\r\n      const configData = configDataAttr ? JSON.parse(configDataAttr) : {};\r\n\r\n      const configDataAndGlobal = { ...globalConfig, ...configData };\r\n\r\n      this._object = {\r\n        index,\r\n        classArray: item.classList,\r\n        ...defaultOptions,\r\n        ...configDataAndGlobal,\r\n        typeElement: configDataAndGlobal.element || \"span\",\r\n        element: item,\r\n      } as ShowMoreInternalObject;\r\n\r\n      this._initial();\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Initial function\r\n   */\r\n  private _initial = (): void => {\r\n    const {\r\n      element,\r\n      after = 0,\r\n      ellipsis,\r\n      nobutton,\r\n      limit = 0,\r\n      type,\r\n    } = this._object;\r\n    // set default aria-expanded to false\r\n    setAttributes(element, { \"showmore-expanded\": \"false\" });\r\n\r\n    const limitCounts = limit + after;\r\n    const ellips = ellipsis === false ? \"\" : \"...\";\r\n\r\n    // text\r\n    if (type === \"text\") {\r\n      const originalText = element.innerHTML.trim();\r\n      const elementText = element.textContent?.trim() || \"\";\r\n\r\n      if (elementText.length > limitCounts) {\r\n        let orgTexReg = originalText;\r\n\r\n        // Optimize: use Object.values instead of for...in\r\n        for (const rule of Object.values(this._regex)) {\r\n          if (rule?.match) {\r\n            orgTexReg = orgTexReg.replace(rule.match, rule.replace);\r\n          }\r\n        }\r\n\r\n        const truncatedText = htmlSubstr(orgTexReg, limit - 1).concat(ellips);\r\n\r\n        element.textContent = \"\";\r\n        element.insertAdjacentHTML(\"beforeend\", truncatedText);\r\n\r\n        this._clickEvent(element, {\r\n          ...this._object,\r\n          originalText,\r\n          truncatedText,\r\n        });\r\n\r\n        if (!nobutton) {\r\n          this._addBtn(this._object);\r\n        }\r\n      }\r\n      return;\r\n    }\r\n\r\n    // list and table\r\n    if (type === \"list\" || type === \"table\") {\r\n      const items = this._getNumberCount(element, type);\r\n\r\n      if (items.length > limitCounts) {\r\n        // Optimize: iterate only from limit to end\r\n        for (let i = limit; i < items.length; i++) {\r\n          addRemoveClass(items[i], true);\r\n        }\r\n\r\n        if (!nobutton) {\r\n          this._addBtn(this._object);\r\n        }\r\n\r\n        // add event click\r\n        this._clickEvent(\r\n          type === \"list\"\r\n            ? element\r\n            : (element.nextElementSibling as HTMLElement),\r\n          this._object,\r\n        );\r\n      }\r\n    }\r\n  };\r\n\r\n  /**\r\n   * Event click\r\n   *\r\n   * @param element - HTMLElement to attach event to\r\n   * @param object - Configuration object\r\n   */\r\n  private _clickEvent = (\r\n    element: HTMLElement | null,\r\n    object: ShowMoreInternalObject,\r\n  ): void => {\r\n    if (!element) return;\r\n    element.addEventListener(\"click\", this._handleEvent.bind(this, object));\r\n  };\r\n\r\n  /**\r\n   * Create button\r\n   *\r\n   * @param config - Configuration object\r\n   * @returns HTMLButtonElement\r\n   */\r\n  private _createBtn = (config: ShowMoreInternalObject): HTMLButtonElement => {\r\n    const { element, number, less, more, type, btnClass, btnClassAppend } =\r\n      config;\r\n\r\n    const typeAria = this._checkExp ? less || \"\" : more || \"\";\r\n    let label = this._checkExp\r\n      ? (less as string).trim() || \"collapse\"\r\n      : (more as string).trim() || \"expand\";\r\n\r\n    // Optimize: cache getNumber result\r\n    const numberText = number ? getNumber(element, type || \"\") : \"\";\r\n    label = number ? label + numberText : label;\r\n\r\n    const button = createElement(\"button\");\r\n\r\n    button.className =\r\n      btnClassAppend == null ? btnClass : `${btnClass} ${btnClassAppend}`;\r\n    setAttributes(button, {\r\n      \"aria-expanded\": this._checkExp,\r\n      \"aria-label\": label,\r\n      tabindex: 0,\r\n    });\r\n\r\n    // Use cached numberText\r\n    button.insertAdjacentHTML(\r\n      \"beforeend\",\r\n      number ? typeAria + numberText : typeAria,\r\n    );\r\n\r\n    return button;\r\n  };\r\n\r\n  /**\r\n   * Event handler\r\n   *\r\n   * @param object - Configuration object\r\n   * @param event - Mouse event\r\n   */\r\n  private _handleEvent = (\r\n    object: ShowMoreInternalObject,\r\n    event: MouseEvent,\r\n  ): void => {\r\n    const { target } = event;\r\n    if (!(target instanceof HTMLElement)) return;\r\n\r\n    const {\r\n      element,\r\n      type,\r\n      limit = 0,\r\n      less,\r\n      typeElement,\r\n      originalText,\r\n      truncatedText,\r\n      btnClass,\r\n    } = object;\r\n\r\n    // check if the button is clicked\r\n    if (!target.classList.contains(btnClass)) return;\r\n\r\n    const showMoreExpanded = element.getAttribute(\"showmore-expanded\");\r\n    this._checkExp = showMoreExpanded === \"false\";\r\n\r\n    // --------------------------------------------------\r\n    // text\r\n    if (type === \"text\") {\r\n      element.textContent = \"\";\r\n\r\n      element.insertAdjacentHTML(\r\n        \"beforeend\",\r\n        this._checkExp ? originalText || \"\" : truncatedText || \"\",\r\n      );\r\n\r\n      if (less) {\r\n        const el = createElement(typeElement as keyof HTMLElementTagNameMap);\r\n        el.classList.add(\"show-more-wrapper\");\r\n        const btn = this._createBtn(object);\r\n        if (btn) el.insertAdjacentElement(\"beforeend\", btn);\r\n        element.appendChild(el);\r\n      }\r\n    }\r\n\r\n    // --------------------------------------------------\r\n    // list and table\r\n    if (type === \"list\" || type === \"table\") {\r\n      const items = this._getNumberCount(element, type);\r\n      const isExpanding = showMoreExpanded === \"false\";\r\n\r\n      if (isExpanding) {\r\n        // Show all: remove hidden class from all\r\n        for (let i = limit; i < items.length; i++) {\r\n          addRemoveClass(items[i], false);\r\n        }\r\n      } else {\r\n        // Hide: add hidden class from limit to end\r\n        const endIndex = type === \"list\" ? items.length - 1 : items.length;\r\n        for (let i = limit; i < endIndex; i++) {\r\n          addRemoveClass(items[i], true);\r\n        }\r\n      }\r\n    }\r\n\r\n    // set aria-expanded\r\n    if (type) {\r\n      this._setExpand({ ...object, target });\r\n    }\r\n  };\r\n\r\n  /**\r\n   * Get number count based on type\r\n   */\r\n  private _getNumberCount = (\r\n    element: HTMLElement,\r\n    type: string,\r\n  ): HTMLElement[] | HTMLCollectionOf<HTMLTableRowElement> => {\r\n    if (type === \"list\") {\r\n      return Array.from(element.children) as HTMLElement[];\r\n    }\r\n    return (element as HTMLTableElement).rows;\r\n  };\r\n\r\n  /**\r\n   * Add button\r\n   *\r\n   * @param object - Configuration object\r\n   */\r\n  private _addBtn = (object: ShowMoreInternalObject): void => {\r\n    const { type, element, more, typeElement } = object;\r\n\r\n    if (!more) return;\r\n\r\n    if (type === \"table\") {\r\n      element.insertAdjacentElement(\"afterend\", this._createBtn(object));\r\n    } else {\r\n      const el = createElement(typeElement as keyof HTMLElementTagNameMap);\r\n      el.classList.add(\"show-more-wrapper\");\r\n      el.appendChild(this._createBtn(object));\r\n      element.appendChild(el);\r\n    }\r\n  };\r\n\r\n  /**\r\n   * Set aria-expanded\r\n   *\r\n   * @param object - Configuration object with target\r\n   */\r\n  private _setExpand = (\r\n    object: ShowMoreInternalObject & { target: EventTarget },\r\n  ): void => {\r\n    const { element, type, less, more, number, target } = object;\r\n\r\n    if (!(target instanceof HTMLElement)) return;\r\n\r\n    const typeAria = this._checkExp ? less : more;\r\n    const aria = this._checkExp ? \"expand\" : \"collapse\";\r\n    const lastChild = element.lastElementChild;\r\n\r\n    // Optimize: cache getNumber result\r\n    const numberText = number ? getNumber(element, type || \"\") : \"\";\r\n    const ariaLabel = number ? typeAria + numberText : typeAria;\r\n\r\n    setAttributes(element, { \"showmore-expanded\": this._checkExp });\r\n    setAttributes(target, {\r\n      \"aria-expanded\": this._checkExp,\r\n      \"aria-label\": ariaLabel,\r\n    });\r\n\r\n    // callback function on more/less\r\n    this._onMoreLess(aria, object);\r\n\r\n    if (typeAria) {\r\n      // Use cached numberText\r\n      target.innerHTML = number ? typeAria + numberText : typeAria;\r\n    } else if (type === \"table\") {\r\n      target.parentNode?.removeChild(target);\r\n    } else if (type === \"list\" && lastChild?.parentNode) {\r\n      lastChild.parentNode.removeChild(lastChild);\r\n    }\r\n  };\r\n}\r\n"],"names":["defaultOptions","typeElement","more","less","number","nobutton","after","btnClass","btnClassAppend","getNumber","element","type","elementType","rows","children","numbersElementHidden","Array","from","filter","el","classList","contains","length","htmlSubstr","originalText","count","div","createElement","insertAdjacentHTML","remaining","walk","track","len","data","substringData","fn","node","firstChild","nodeType","childNodes","nextSibling","innerHTML","addRemoveClass","setAttributes","attributes","key","setAttribute","String","document","defaultRegex","newLine","match","replace","space","br","html","ShowMore","className","config","_checkExp","_initial","ellipsis","limit","_object","limitCounts","ellips","trim","elementText","textContent","orgTexReg","rule","Object","values","_regex","truncatedText","concat","_clickEvent","_addBtn","items","_getNumberCount","i","nextElementSibling","object","addEventListener","_handleEvent","bind","_createBtn","typeAria","label","numberText","button","tabindex","event","target","HTMLElement","showMoreExpanded","getAttribute","add","btn","insertAdjacentElement","appendChild","isExpanding","endIndex","_setExpand","aria","lastChild","lastElementChild","ariaLabel","_onMoreLess","parentNode","removeChild","onMoreLess","regex","globalConfig","elements","querySelectorAll","forEach","item","index","configDataAttr","configData","JSON","parse","configDataAndGlobal","classArray"],"mappings":"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"}